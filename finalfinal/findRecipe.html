<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Recipe</title>
    <!-- Bootstrap CSS -->
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css' 
        rel='stylesheet' integrity='sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx' 
        crossorigin='anonymous'>
    <!-- Axios -->
    <script src='https://unpkg.com/axios/dist/axios.js'></script>

    <link rel="stylesheet" href="findRecipe.css"/>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Vue 3 -->
  <script src='https://cdn.jsdelivr.net/npm/vue@next'></script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="keywords"
    content="Easycook, â€‹Coffee &amp;amp; 01, 02, 03, 04, Receipe, Marketplace">
  <meta name="description" content="">
  <title>Home</title>
  <link rel="stylesheet" href="nicepage.css" media="screen">
  <link rel="stylesheet" href="Page-1.css" media="screen">
  <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
  <meta name="generator" content="Nicepage 4.21.5, nicepage.com">
  <link id="u-theme-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
  <link id="u-page-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Oswald:200,300,400,500,600,700|Lato:100,100i,300,300i,400,400i,700,700i,900,900i|Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i">


  <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/default-logo.png"
}</script>
  <meta name="theme-color" content="#478ac9">
  <meta property="og:title" content="Page 1">
  <meta property="og:type" content="website">
  <style>
    #logoutbtn{
      border:white;
      /* background-color:#F8F7F6; */
      background: none;
    }
    #recipebtn{
      border:white;
      /* background-color:#F8F7F6; */
      background: none;
    }
    #profilebtn{
      border:white;
      /* background-color:#F8F7F6; */
      background: none;
    }
    #marketplacebtn{
      border:white;
      /* background-color:#F8F7F6; */
      background: none;
    }
  </style>
  
  
</head>
<body class="u-body u-xl-mode d-flex flex-column min-vh-100" data-lang="en" style='background-color:#F8F7F6'>
  <header class="u-clearfix u-header u-header" id="sec-6f6c">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <a href="aboutUs.html" class="u-image u-logo u-image-1">
        <!-- <img src="images/default-logo.png" class="u-logo-image u-logo-image-1"> -->
        Easycook
      </a>
      <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
        <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
          <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
            href="#">
            <svg class="u-svg-link" viewBox="0 0 24 24">
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
            </svg>
            <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px"
              xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
              <g>
                <rect y="1" width="16" height="2"></rect>
                <rect y="7" width="16" height="2"></rect>
                <rect y="13" width="16" height="2"></rect>
              </g>
            </svg>
          </a>
        </div>
        <div class="u-nav-container">
          <ul class="u-nav u-unstyled u-nav-1">
            <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="home.html"
                style="padding: 10px 20px;">Home</a>
            </li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="findRecipe.html"
                style="padding: 10px 20px;"><button id="recipebtn">Recipes</button></a>
            </li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="marketplace.html"
                style="padding: 10px 20px;"><button id="marketplacebtn">Marketplace</button></a>
            </li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="profile.html"
                style="padding: 10px 20px;"><button id="profilebtn">Profile</button></a>
            </li>
            <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base"
              style="padding: 10px 20px;"><button id="logoutbtn">Logout</button></a>
            </li>
          </ul>
        </div>

        <div class="u-nav-container-collapse">
          <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
            <div class="u-inner-container-layout u-sidenav-overflow">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="home.html">Home</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="findRecipe.html"><button id="recipebtn">Recipes</button></a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="marketplace.html"><button id="marketplacebtn">Marketplace</button></a></a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="profile.html"><button id="profilebtn">Profile</button></a>
                </li>
                <li class="u-nav-item"><a class=" u-button-style u-nav-link"><button id="logoutbtn">Logout</button></a>
                </li>
              </ul>
            </div>
          </div>
          <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
        </div>

      </nav>

    </div>
  </header>

  <div class="container text-center" id="app">
    <div class="meal-search">
        <h2 class="title">Find Recipes For Your Ingredients
          <span class="info-tool-tip">
            <i class="fa-solid fa-circle-info"></i>
            <span id="tooltip-text" style="text-align: left;">Step 1: Press 'enter' key to add ingredient(s), click on the pill to delete ingredient <br> Step 2: Click on search button to search for recipes</span>
          </span>

        </h2>

        <!-- Search Input -->
        <div class="meal-search-box">
            <input type="text" class="search-control" placeholder="Enter Ingredients" id="search-input" v-model="tempIngredients" @keyup.enter="addIngredients"> 
            <button class="search-btn button" @click="getRecipes">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button> 
        </div>

        <div v-for="ingredient in ingredients" class="pill" >
          <span @click="deleteIngredient(ingredient)">{{ingredient}}</span>
        </div>

    </div>
</div>

<div class="container">
                  <!-- Display API results retrieved -->
  <div class="meal-result text-center">
    <div id="meal">

    </div>
  </div>
            

  <div class="meal-details" style="text-align: center;">
    <!-- Recipe close button -->
    <button class="recipe-close-btn button" id="recipe-close-btn">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <!-- Recipe Instructions Content -->
    <div class="meal-intructions-content">

    </div>
  </div>

  <div class="ingredient-details text-center">
    <!-- Ingredients close button -->
    <button class="ingredients-close-btn button" id="ingredients-close-btn">
      <i class="fa-solid fa-xmark"></i>
    </button>
    
    <!-- Ingredients Content -->
    <div class="meal-ingredients-content">

    </div>
  </div>
</div>

  <!-- Footer -->
  <footer class="py-2 mt-auto border-top-1 border">
    <p class="text-center text-muted pt-2">&copy; 2022 Easycook, Inc</p>
    <ul class="nav justify-content-center  mb-3">
        <li class="nav-item"><a href="" class="nav-link px-2 text-muted">Home</a></li>
        <li class="nav-item"><a href="" class="nav-link px-2 text-muted">Recipes</a></li>
        <li class="nav-item"><a href="" class="nav-link px-2 text-muted">Marketplace</a></li>
        <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">FAQs</a></li>
        <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">About</a></li>
      </ul>
  </footer>
        
    
    <!-- Bootstrap Javascript -->
    <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js'
        integrity='sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa' 
        crossorigin='anonymous'></script>
    <script src="findRecipe.js"></script>

</body>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
  import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js";
  import{
  getFirestore, doc, getDoc, setDoc, collection, addDoc, updateDoc, deleteDoc, deleteField
  }
  from "https://www.gstatic.com/firebasejs/9.12.1/firebase-firestore.js";

  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyCUwFb-W_pR0s_iO2tplBAxXXakhVWs8lM",
    authDomain: "g2t5-wad2.firebaseapp.com",
    databaseURL: "https://g2t5-wad2-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "g2t5-wad2",
    storageBucket: "g2t5-wad2.appspot.com",
    messagingSenderId: "634091812622",
    appId: "1:634091812622:web:9c1e64920c60792226495f",
    measurementId: "G-MJKTY27Q23"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const analytics = getAnalytics(app);
  const db = getFirestore();



  // Update database when user wants to logout
  let logoutbtn =  document.getElementById("logoutbtn");
  async function logout(){
    let email = localStorage.getItem("UserEmail")
    console.log(email)
    var ref = doc(db, "Users", email);
    await updateDoc(
        ref, {
            recipes: JSON.parse(localStorage.getItem('likedRecipes')),
            }
        )
        .then(()=>{
            alert("Logout Successful");
            window.location = "login.html";
            window.history.forward();
        })
        .catch((error)=>{
            alert("Logout Unsuccessful" + error);
        });
  }
  logoutbtn.addEventListener("click",logout);

  // Update Database when user click onto any button in nav bar
  let recipebtn =  document.getElementById("recipebtn");
  let profilebtn = document.getElementById("profilebtn");
  let marketplacebtn = document.getElementById("marketplacebtn");

  async function UpdateRecipes(){
        let email = localStorage.getItem("UserEmail")
        if (localStorage.getItem('recipes')===null){
          let likedRecipes =[]
        }
        let likedRecipes = JSON.parse(localStorage.getItem("likedRecipes"))
        var ref = doc(db, "Users", email);
        
        await updateDoc(
            ref, {
                recipes: likedRecipes
                }
            )
            .then(()=>{
                console.log("Recipes Updated");
            })
            .catch((error)=>{
                alert("Recipes Updating Unsuccessful" + error);
            });
  }

  profilebtn.addEventListener('mouseover',UpdateRecipes)
  recipebtn.addEventListener("mouseover",UpdateRecipes);
  marketplacebtn.addEventListener("mouseover",UpdateRecipes)

</script>

</html>




