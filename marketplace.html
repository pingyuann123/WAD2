<!-- <?php
// Start the session
session_start();
?> -->

<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <link rel="stylesheet" href="marketplace.css"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <meta charset="utf-8"> -->
  <meta name="keywords"
    content="Easycook, â€‹Coffee &amp;amp; 01, 02, 03, 04, Receipe, Marketplace">
  <meta name="description" content="">
  <title>Marketplace</title>
  <link rel="stylesheet" href="nicepage.css" media="screen">
  <link rel="stylesheet" href="Page-1.css" media="screen">
  <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
  <meta name="generator" content="Nicepage 4.21.5, nicepage.com">
  <link id="u-theme-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
  <link id="u-page-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Oswald:200,300,400,500,600,700|Lato:100,100i,300,300i,400,400i,700,700i,900,900i|Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i">

  <!-- Add icon library -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

   <!-- VUE -->
   <script src="https://unpkg.com/vue@next"></script>
  <style>
    .card {
      margin: 10px;
    }
  </style>


    <title>Home</title>

    <script type="application/ld+json">{
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "",
      "logo": "images/default-logo.png"
  }</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Page 1">
    <meta property="og:type" content="website">
</head>
<body>
    <!-- https://icons.getbootstrap.com/ -->

    <!--NavBar-->

    <header class="u-clearfix u-header u-header" id="sec-6f6c">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <!-- <a href="https://nicepage.com" class="u-image u-logo u-image-1">
          <img src="images/default-logo.png" class="u-logo-image u-logo-image-1">
          Easycook
        </a> -->
        <p></p>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
              href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
              </svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px"
                xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <rect y="1" width="16" height="2"></rect>
                  <rect y="7" width="16" height="2"></rect>
                  <rect y="13" width="16" height="2"></rect>
                </g>
              </svg>
            </a>
          </div>
          <div class="u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1">
              <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="Home.html"
                  style="padding: 10px 20px;">Home</a>
              </li>
              <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="findRecipe.html"
                  style="padding: 10px 20px;">Receipe</a>
              </li>
              <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="marketplace.html"
                  style="padding: 10px 20px;">Marketplace</a>
              </li>
              <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="profile.html"
                  style="padding: 10px 20px;">Profile</a>
              </li>
              <li class="u-nav-item"><a class="u-button-style u-nav-link  u-text-hover-palette-1-base" href="login.html"
                  style="padding: 10px 20px;">Logout</a>
              </li>
            </ul>
          </div>
  
          <div class="u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                  <li class="u-nav-item"><a class="u-button-style u-nav-link" href="home.html">Home</a>
                  </li>
                  <li class="u-nav-item"><a class="u-button-style u-nav-link" href="findRecipe.html">Receipe</a>
                  </li>
                  <li class="u-nav-item"><a class="u-button-style u-nav-link" href="marketplace.html">Marketplace</a>
                  </li>
                  <li class="u-nav-item"><a class="u-button-style u-nav-link" href="profile.html">Profile</a>
                  </li>
                  <li class="u-nav-item"><a class="u-button-style u-nav-link" href="login.html">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
  
        </nav>
  
      </div>
    </header>

      <div class="container-fluid">
        <div class="header2 row">
          <div class="col-lg-6">
            <p class="subtext">Marketplace | Where you share your unused ingredients or cooked food</p>
          </div>
        

          <div class="col-lg-6">
            <button id = "createBtn" class="createBtn btn btn-md btn-block" type="button" onclick="window.location.href='createPD.html';">+ Create New Listing</button>
            <button class="chatBtn btn btn-md btn-block" ><i class="fa fa-comments"></i> Chat</button>
          </div>


          <!-- <div class="col-lg-6">
            <p class="subtext">where you share your unused ingredients or cooked food</p  >
          </div> -->
        </div>
        </div>
        <div class="container-fluid">
            <div class="row">
              <!-- <div class="col-md-2 col-sm-2"> -->
                <div id = 'app' style = 'display: flex;'>
                </div>
            <!-- </div> -->

            <!-- <divcard @storekey="storekey"></divcard> -->
          </div>
        </div>

                    <!-- firebase -->
          
                    <script type = 'module'>

                      // Import the functions you need from the SDKs you need
                      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
                      import { getDatabase, ref, child, onValue, get } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js";
                 
                       // TODO: Add SDKs for Firebase products that you want to use
                       // https://firebase.google.com/docs/web/setup#available-libraries
                     
                       // Your web app's Firebase configuration
                       // For Firebase JS SDK v7.20.0 and later, measurementId is optional
                       const firebaseConfig = {
                         apiKey: "AIzaSyCUwFb-W_pR0s_iO2tplBAxXXakhVWs8lM",
                         authDomain: "g2t5-wad2.firebaseapp.com",
                         databaseURL: "https://g2t5-wad2-default-rtdb.asia-southeast1.firebasedatabase.app",
                         projectId: "g2t5-wad2",
                         storageBucket: "g2t5-wad2.appspot.com",
                         messagingSenderId: "634091812622",
                         appId: "1:634091812622:web:9c1e64920c60792226495f",
                         measurementId: "G-MJKTY27Q23"
                       };
                     
                       // Initialize Firebase
                       const firebase_app = initializeApp(firebaseConfig);
                       const db = getDatabase();
                      //  var childkey = "";

                       const app = Vue.createApp({
                         data(){
                           return{
                           title: '',
                           desc: '',
                           price: '',
                           date: '',
                           location: '',
                           childkey:'' 
                         }}, 
          
                         methods:{
                            async GetADocument(){
                              const dbRef = ref(db, 'ProductList');
                              console.log(dbRef)
                              onValue(dbRef, (snapshot) => {
                              snapshot.forEach((childSnapshot) => {
                                  const childKey = childSnapshot.key;
                                  const childData = childSnapshot.val();
                                  console.log(childKey);
                                  console.log(childData)
                                  var price = childData.productPrice;
                                  var title = childData.productTitle;
                                  var image = childData.productImgName;
                                  var expiry = childData.productDate;
                                  var childkey = childData.productID;
                                  addToList(price, expiry, title, image,childkey);
                                  // let childkey = childKey;
                                  // console.log(childkey);
                                  


                          });}, 
                              {
                                onlyOnce: true
                                });
                         },
                         storekey:function storekey(){
                  
                            var para = new URLSearchParams();

                            console.log(childKey);
                            para.append("productid", childKey);
                            window.location = "product_page.html?" + para.toString();
                              // (C) REDIRECT
                            window.location = "product_page.html";
                            // window.open("1b-session.html")
                        }
                        },
          
                         created(){
                           this.GetADocument()
                         }
          
                 }).mount('#app')
                //  console.log(childkey);
                //  let passBtn = document.getElementById("passBtn");
                //  console.log(passBtn);  


                //  passBtn.addEventListener("click",storekey);
                   </script>
                   <script>
                     function addToList(price, date, title, image,childkey) {

                      var div = document.getElementById('app');
                      var divcard = document.createElement('div');
                      divcard.innerHTML = `
                            <div class="col-lg-12 col-md-2 col-sm-2">
                            <div class="card" style="width: 18rem;">
                              <form action ="product_page.html" method="get" target="_blank">
                              <img class="card-img-top" src="img/${image}" alt="Card image cap">
                              <div class="card-body">
                              <h5 class="card-title">${title}<span style = 'float:right'>$${price}</span></h5>
                              <p class="card-text"><strong><small>GOOD TILL: ${date}</small><strong></p>
                              <input type ="text" value ="${childkey}" name="productid" style = 'display:none'/>
                              </div>
                              <button id = "passBtn" class="bckBtn btn btn-sm btn-block"type="submit">Details</button>
                              </form
                            </div>
                            </div>
                            <br>
                            `

                      div.appendChild(divcard);
                     }
                   </script>
      </div>


    </body>
</html>